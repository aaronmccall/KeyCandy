KeyCandy=function($,undefined){var agent=navigator.userAgent,os=/Linux|Windows|Macintosh/.exec(agent).toString().toLowerCase(),browser=agent.indexOf("WebKit")>-1?"webkit":/Gecko|MSIE|Opera/.exec(agent).toString().toLowerCase(),os_browser_map={macintosh:91,linux:17,windows:17},target,_class="keycandy",_remove_class="removeClass",_default_parent="body",_control_key=os_browser_map[os]?os_browser_map[os]:17,_req_control_key=false,_valid_mod_keys={"⇧":16,shift:16,option:18,"⌥":18,alt:18,ctrl:17,control:17,command:91,"⌘":91},_mod_key="alt",_active_mods={16:false,17:false,18:false,91:false},attr_key_map={windows:"ctrl",linux:"ctrl",macintosh:String.fromCharCode(parseInt("2318",16))},handle_keydown=function(event){var _target=event.target,$class_target=$(target||_default_parent),_tag=_target.tagName.toLowerCase(),$target=$(_target),_code=event.keyCode,_accesskey_event=_active_mods[_control_key]||!_req_control_key,_valid_accesskey_code=_code>47&&_code<58||_code>64&&_code<91||_code>96&&_code<123,_selector=_valid_accesskey_code?'[accesskey="'+String.fromCharCode(_code)+'"]':null,$el=_selector?$(_selector):null,_old_idx,_typeable,_click_link=function(link){var cancelled=false;if(document.createEvent){var event=document.createEvent("MouseEvents");event.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);cancelled=!link.dispatchEvent(event)}else if(link.fireEvent){cancelled=!link.fireEvent("onclick")}if(!cancelled&&link.href)window.location=link.href};if(_code==93||_code==224)_code=91;if(_code==17&&window.opera&&_control_key==91&&event.ctrlKey===false)_code=91;if(_active_mods[_code]!==undefined)_active_mods[_code]=true;_typeable=(/^(sel|tex)/.test(_tag)||_tag==="input"&&/^(tex|pas|ema|sea|tel|url|dat)/.test(_target.type))&&!_active_mods[_valid_mod_keys[_mod_key]];if(_code===_control_key&&!_typeable){$class_target.toggleClass(_class)}else{if(_accesskey_event&&!_typeable){if(_valid_accesskey_code){if($el.length){$el=$el.is("label")?$("#"+$el.attr("for")):$el;var el=$el[0],el_tag=el.tagName.toLowerCase();var _action=$el.is(":text, :password, textarea, select")?"focus":"click";if(el_tag=="a"&&el.href){_click_link(el)}else if(el_tag=="select"&&browser=="gecko"&&_tag!="select"){!function(el,_idx){setTimeout(function(){el.selectedIndex=_idx},0)}(el,el.selectedIndex)}event.stopPropagation();event.preventDefault();$el.trigger(_action)}}$class_target[_remove_class](_class)}}},unset_modkey=function(event){var _code=event.keyCode;if(_code==93||_code==224)_code=91;if(window.opera&&_code==17&&event.ctrlKey===false)_code=91;if(_code in _active_mods){_active_mods[_code]=false}};return{version:"1.0.1",init:function(opt){if(opt){if(opt.ctrlKey)_control_key=opt.ctrlKey;if(opt.reqCtrlKey)_req_control_key=opt.reqCtrlKey;if(opt.modKey&&_valid_mod_keys[opt.modKey])_mod_key=opt.modKey;if(opt.tooltipClass)_class=opt.tooltipClass;if(opt.domLib)$=opt.domLib;target=opt.parent||_default_parent}else{target=_default_parent}$(browser=="msie"?document:window).bind("keydown",handle_keydown).bind("keyup",unset_modkey);$(target).bind("click",function(){$(this)[_remove_class](_class)}).attr("data-kchint","Press ["+attr_key_map[os]+"] to hide tooltips.")},os:os,browser:browser}}(window.KEYCANDY_DOM_LIB||window.$);