// (c) 2011 Aaron McCall.
// Contributors: Beau Sorenson
// [MIT license](http://creativecommons.org/licenses/MIT/).
// Key Candy makes your web app melt in your hands not on your mouse!
// Provides tooltips for elements with accesskey attributes and focuses/activates
// elements with an accesskey in a standardized, cross-browser, cross-platform way.
KeyCandy=function(a,b){var c=navigator.userAgent,d=/Linux|Windows|Macintosh/.exec(c).toString().toLowerCase(),e=c.indexOf("WebKit")>-1?"webkit":/Gecko|MSIE|Opera/.exec(c).toString().toLowerCase(),f={macintosh:91,linux:17,windows:17},g,h="keycandy",i="removeClass",j="body",k=f[d]?f[d]:17,l=!1,m={"⇧":16,shift:16,option:18,"⌥":18,alt:18,ctrl:17,control:17,command:91,"⌘":91},n="alt",o={16:!1,17:!1,18:!1,91:!1},p={windows:"ctrl",linux:"ctrl",macintosh:String.fromCharCode(parseInt("2318",16))},q=function(c){var d=f?a(f):a(j),f=c.target,g=f.tagName.toLowerCase(),p=a(f),q=c.keyCode,r=o[k]||!l,s=q>47&&q<58||q>64&&q<91||q>96&&q<123,t=s?'[accesskey="'+String.fromCharCode(q)+'"]':null,u=t?a(t):null,v,w,x=function(a){var b=!1;if(document.createEvent){var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),b=!a.dispatchEvent(c)}else a.fireEvent&&(b=!a.fireEvent("onclick"));!b&&a.href&&(window.location=a.href)};if(q==93||q==224)q=91;q==17&&window.opera&&k==91&&c.ctrlKey===!1&&(q=91),o[q]!==b&&(o[q]=!0),w=(/^(sel|tex)/.test(g)||g==="input"&&/^(tex|pas|ema|sea|tel|url|dat)/.test(f.type))&&!o[m[n]];if(q===k&&!w)d.toggleClass(h);else if(r&&!w){if(s&&u.length){u=u.is("label")?a("#"+u.attr("for")):u;var y=u[0],z=y.tagName.toLowerCase(),A=u.is(":text, :password, textarea, select")?"focus":"click";z=="a"&&y.href?x(y):z=="select"&&e=="gecko"&&g!="select"&&function(a,b){setTimeout(function(){a.selectedIndex=b},0)}(y,y.selectedIndex),c.stopPropagation(),c.preventDefault(),u.trigger(A)}d[i](h)}},r=function(a){var b=a.keyCode;if(b==93||b==224)b=91;window.opera&&b==17&&a.ctrlKey===!1&&(b=91),b in o&&(o[b]=!1)};return{version:"1.0",init:function(b){b||(b={}),b.ctrlKey&&(k=b.ctrlKey),b.reqCtrlKey&&(l=b.reqCtrlKey),b.modKey&&m[b.modKey]&&(n=b.modKey),g=b.parent||j,a(e=="msie"?document:window).bind("keydown",q).bind("keyup",r),a(g).bind("click",function(){a(this)[i](h)}).attr("data-kchint","Press ["+p[d]+"] to hide tooltips.")},os:d,browser:e}}(window.jQuery)