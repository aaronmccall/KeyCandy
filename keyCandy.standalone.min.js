// **gobSmack** (c) 2011 Aaron McCall.
// A lightweight, minimalist set of DOM and event tools that was
// created to replace jQuery in KeyCandy's standalone version.
var gobSmack=function(){function m(a,b,c){var d=a.addEventListener?function(a,b,c){a.addEventListener(b,c,!0)}:function(a,b,c){a.attachEvent("on"+b,c)};return m=d,d(a,b,c)}function n(a,b){return e(b).test(a.className)}function o(a,b){var c;n(a,b)||(c=a.className.split(/\s+/g),c.push(b),a.className=c.join(" "))}function p(a,b){a.className=a.className.replace(e(b),"").replace(/^\s+/,"")}function q(a,b){n(a,b)?p(a,b):o(a,b)}function r(a,b){return b in a&&a[b](),this}function s(a,b,c){var d=document.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};s=d,d(a,b,c)}function t(a,b,c){var d=h()?function(a,b,c){return a.setAttribute(b,c)}:function(a,b,c){return i[name]&&(name=i[name]),name==="value"&&element.nodeName==="BUTTON"?element.getAttributeNode(name).nodeValue=value:element.setAttribute(name,value)};return t=d,d(a,b,c)}function u(a,b){var c=h()?function(a,b){return a.getAttribute(b)}:function(a,b){return i[b]&&(b=i[b]),j[b]?a.getAttribute(b,2):b==="value"&&a.nodeName==="BUTTON"?a.getAttributeNode(b).nodeValue:a.getAttribute(b)};return u=c,c(a,b)}function v(a,b){var c=h()?function(a,b){if("1-9".indexOf(""+a.nodeType)<0)return;t(a,b,""),a.removeAttributeNode(a.getAttributeNode(b))}:function(a,b){a.removeAttribute(b)};return v=c,c(a,b)}var a=function(a){return Array.prototype.slice.call(a)},b=function(a,c){var d=typeof Array.prototype.indexOf=="function"?function(a,b){return Array.prototype.indexOf.call(a,b)}:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1};return b=d,d(a,c)},c=function(b,c){return"bind"in c&&typeof c.bind=="function"?c.bind(b):function(){c.apply(b,a(arguments))}},d=function(a){return new k(a)},e=function(a){return new RegExp("\\b"+a+"\\b")},f=[],g={},h=function(){var a=document.createElement("div");return a.innerHTML='<a href="/example"></a>',a.childNodes[0].getAttribute("href")==="/example"?(h=function(){return!0},!0):(a=null,h=function(){return!1},!1)},i={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},j={width:!0,height:!0,src:!0,href:!0},k=function(b){if(typeof b=="string"){this.el=document.querySelectorAll(b),this.length=this.el.length;if(this.el.length==1)this[0]=this.el=a(this.el).pop();else for(var c=0,d=a(this.el),e=d.length;c<e;c++)c===0&&(this.el=d[c]),this[c]=d[c]}else if(b.nodeType||b===window||b===document)this.el=this[0]=b,this.length=1},l=k.prototype;return l.is=function(a){var b=!1,c;if(a.indexOf(",")>=0){c=a.split(/,\s*/g);for(var d=0,e=c.length;d<e;d++){if(c[d].toLowerCase()===this.el.tagName.toLowerCase())return!0;if(c[d].indexOf(":")==0&&c[d].substr(1).toLowerCase()===this.el.type)return!0}}return a.toLowerCase()===this.el.tagName.toLowerCase()},l.bind=function(a,c){var d;for(var e=0;e<this.length;e++)b(f,this[e])<0&&f.push(this[e]),d=b(f,this[e]),g[d]=g[d]||{},g[d][a]=g[d][a]||[],b(g[d][a],c)<0&&(m(this[e],a,c),g[d][a].push(c));return this},l.hasClass=function(a){return n(this.el,a)},l.addClass=function(a){for(var b=0;b<this.length;b++)o(this[b],a);return this},l.removeClass=function(a){for(var b=0;b<this.length;b++)p(this[b],a);return this},l.toggleClass=function(a){for(var b=0;b<this.length;b++)q(this[b],a);return this},l.trigger=function(a){for(var b=0;b<this.length;b++)r(this[b],a);return this},l.one=function(a,b){var d=c(this.el,b),e=c(this,function(b){d(b),this.unbind(a,e)});return this.bind(a,e),this},l.unbind=function(a,b){for(var c=0;c<this.length;c++)s(this[c],a,b);return this},l.attr=function(a,b){if(b===undefined)return u(this.el,a);for(var c=0;c<this.length;c++)b===null?v(this[c],a):t(this[c],a,b);return this},l.prop=function(a,b){var c=i[a]?i[a]:a;if(c in this.el){if(typeof b===undefined)return this.el[c];this.el[c]=b}},l.html=function(a){for(var b=0;b<this.length;b++)this[b].innerHTML=a;return this},d}();KeyCandy=function(a){var b=navigator.userAgent,c=/Linux|Windows|Macintosh/.exec(b).toString().toLowerCase(),d=b.indexOf("WebKit")>-1?"webkit":/Gecko|MSIE|Opera/.exec(b).toString().toLowerCase(),e={macintosh:91,linux:17,windows:17},f,g="keycandy",h="removeClass",i="body",j=e[c]?e[c]:17,k=!1,l={"⇧":16,shift:16,option:18,"⌥":18,alt:18,ctrl:17,control:17,command:91,"⌘":91},m="alt",n={16:!1,17:!1,18:!1,91:!1},o={windows:"ctrl",linux:"ctrl",macintosh:String.fromCharCode(parseInt("2318",16))},p=function(b){var c=e?a(e):a(i),e=b.target,f=e.tagName.toLowerCase(),o=a(e),p=b.keyCode,q=n[j]||!k,r=p>47&&p<58||p>64&&p<91||p>96&&p<123,s=r?'[accesskey="'+String.fromCharCode(p)+'"]':null,t=s?a(s):null,u,v,w=function(a){var b=!1;if(document.createEvent){var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),b=!a.dispatchEvent(c)}else a.fireEvent&&(b=!a.fireEvent("onclick"));!b&&a.href&&(window.location=a.href)};if(p==93||p==224)p=91;p==17&&window.opera&&j==91&&b.ctrlKey===!1&&(p=91),n[p]!==undefined&&(n[p]=!0),v=(/^(sel|tex)/.test(f)||f==="input"&&/^(tex|pas|ema|sea|tel|url|dat)/.test(e.type))&&!n[l[m]];if(p===j&&!v)c.toggleClass(g);else if(q&&!v){if(r&&t.length){t=t.is("label")?a("#"+t.attr("for")):t;var x=t[0],y=x.tagName.toLowerCase(),z=t.is(":text, :password, textarea, select")?"focus":"click";y=="a"&&x.href?w(x):y=="select"&&d=="gecko"&&f!="select"&&function(a,b){setTimeout(function(){a.selectedIndex=b},0)}(x,x.selectedIndex),b.stopPropagation(),b.preventDefault(),t.trigger(z)}c[h](g)}},q=function(a){var b=a.keyCode;if(b==93||b==224)b=91;window.opera&&b==17&&a.ctrlKey===!1&&(b=91),b in n&&(n[b]=!1)};return{version:"1.0",init:function(b){b||(b={}),b.ctrlKey&&(j=b.ctrlKey),b.reqCtrlKey&&(k=b.reqCtrlKey),b.modKey&&l[b.modKey]&&(m=b.modKey),f=b.parent||i,a(d=="msie"?document:window).bind("keydown",p).bind("keyup",q),a(f).bind("click",function(){a(this)[h](g)}).attr("data-kchint","Press ["+o[c]+"] to hide tooltips.")},os:c,browser:d}}(gobSmack)